<%- include('../partials/_head') %>
<link rel="stylesheet" href="/css/home.css" />

<%
  // PapÃ©is vindos de res.locals.auth (mesmo padrÃ£o da sidebar)
  const r = (typeof auth?.role === 'string' ? auth.role : '').toUpperCase();
  const isAdmin = !!auth?.isAdmin;
  const isAtendente = !!auth?.isAtendente;
  const isMedico = !!auth?.isMedico;

  // Rotas iguais Ã s usadas na sidebar (mantÃ©m padrÃ£o)
  const PACIENTES_PATH = isMedico ? '/pacientes-medico' : '/pacientes';
  const ROUTES = {
    home: '/',
    agenda: '/agenda',
    pacientes: PACIENTES_PATH,
    cadastro: '/cadastro',
    relatorio: '/relatorio',
    perfil: '/perfil',
  };
%>

<div class="home-wrap">
  <!-- HERO -->
  <section class="hero">
    <div class="hero__inner">
      <div class="hero__left">
        <h1 class="hero__title">Bem-vindo ao <span>Connect Health</span></h1>
        <p class="hero__subtitle">
          Plataforma de gestÃ£o para atendimento domiciliar: agenda inteligente, cadastro de pacientes,
          acompanhamento de consultas e relatÃ³rios â€” tudo em um sÃ³ lugar.
        </p>
        <div class="hero__cta">
          <% if (isAtendente || isMedico) { %>
            <a class="btn" href="<%= ROUTES.agenda %>">Abrir Agenda</a>
          <% } %>
          <a class="btn btn--ghost" href="<%= ROUTES.perfil %>">Ver meu Perfil</a>
        </div>
      </div>
      <div class="hero__right">
        <div class="hero-card">
          <div class="hero-card__stat">
            <div class="k">Seu papel</div>
            <div class="v"><%= r || 'â€”' %></div>
          </div>
          <div class="hero-card__stat">
            <div class="k">Acesso rÃ¡pido</div>
            <div class="v">
              <% if (isAtendente || isMedico) { %>
                Agenda, Pacientes
              <% } else if (isAdmin) { %>
                Cadastro, RelatÃ³rios
              <% } else { %>
                Perfil
              <% } %>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- FEATURES / recursos do sistema -->
  <section class="features">
    <article class="feat">
      <div class="feat__icon">ğŸ—“ï¸</div>
      <h3 class="feat__title">Agenda de Home Care</h3>
      <p class="feat__desc">
        Disponibilize horÃ¡rios individuais ou em lote, visualize confirmadas e pendentes, e gerencie confirmaÃ§Ãµes.
      </p>
      <% if (isAtendente || isMedico) { %>
        <a class="link" href="<%= ROUTES.agenda %>">Ir para Agenda â†’</a>
      <% } %>
    </article>

    <article class="feat">
      <div class="feat__icon">ğŸ‘¥</div>
      <h3 class="feat__title">Pacientes</h3>
      <p class="feat__desc">
        Cadastro completo com dados essenciais para o atendimento, histÃ³rico e informaÃ§Ãµes de contato.
      </p>
      <% if (isAtendente || isMedico) { %>
        <a class="link" href="<%= ROUTES.pacientes %>">Abrir Pacientes â†’</a>
      <% } %>
    </article>

    <article class="feat">
      <div class="feat__icon">ğŸ“Š</div>
      <h3 class="feat__title">RelatÃ³rios</h3>
      <p class="feat__desc">
        ExportaÃ§Ã£o de dados e visualizaÃ§Ãµes para acompanhamento operacional e decisÃ£o tÃ©cnica.
      </p>
      <% if (isAdmin) { %>
        <a class="link" href="<%= ROUTES.relatorio %>">Ver RelatÃ³rios â†’</a>
      <% } %>
    </article>

    <article class="feat">
      <div class="feat__icon">ğŸ§©</div>
      <h3 class="feat__title">Cadastro de UsuÃ¡rios</h3>
      <p class="feat__desc">
        GestÃ£o de administradores, atendentes e mÃ©dicos com papÃ©is e permissÃµes.
      </p>
      <% if (isAdmin) { %>
        <a class="link" href="<%= ROUTES.cadastro %>">Ir para Cadastro â†’</a>
      <% } %>
    </article>
  </section>

  <!-- AÃ‡Ã•ES RÃPIDAS -->
  <section class="quick">
    <h2 class="quick__title">AÃ§Ãµes rÃ¡pidas</h2>
    <div class="quick__grid">
      <% if (isAtendente || isMedico) { %>
        <a class="qbtn" href="<%= ROUTES.agenda %>">+ Disponibilizar horÃ¡rios</a>
        <a class="qbtn" href="<%= ROUTES.pacientes %>">+ Novo paciente</a>
      <% } %>
      <% if (isAdmin) { %>
        <a class="qbtn" href="<%= ROUTES.cadastro %>">+ Criar usuÃ¡rio</a>
        <a class="qbtn" href="<%= ROUTES.relatorio %>">â†’ Exportar relatÃ³rios</a>
      <% } %>
      <a class="qbtn" href="<%= ROUTES.perfil %>">âš™ï¸ Meu perfil</a>
    </div>
  </section>
</div>

<script src="/js/home.js"></script>
<%- include('../partials/_foot') %>
